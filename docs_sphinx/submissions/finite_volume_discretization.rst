.. _submissions_finite_volume_discretization:

.. role:: raw-html(raw)
    :format: html

2. Finite Volume Discretization
===============================

Add exercise.

2.1. Shock and Rarefaction Waves
--------------------------------

Play around
^^^^^^^^^^^

l_hl...height of left side :raw-html:`<br>`
l_hr...height of right side :raw-html:`<br>`
l_ml...momentum of left side :raw-html:`<br>`
l_location...location

All results with 3 cells!

+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  l_hl  |  l_hr  | l_hul  |  l_ul  |  l_location |  Setup    |  :math:`\lambda_1`  |  :math:`\lambda_2`  |
+========+========+========+========+=============+===========+=====================+=====================+
|  10    |   15   |   /    |   /    |      5      | Dam-Break |      -9.90285       |       9.90285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  10    |   15   |   8    |  0.8   |      5      | Rare-Rare |      -10.7029       |       9.10285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  10    |   15   |   8    |  0.8   |      5      |Shock-Shock|      -9.10285       |       10.7029       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  10    |   15   |   /    |   /    |      5      | Dam-Break |      -9.90285       |       9.90285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  10    |   15   |   0    |   0    |      5      | Rare-Rare |      -9.90285       |       9.90285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  10    |   15   |   0    |   0    |      5      |Shock-Shock|      -9.90285       |       9.90285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  15    |   15   |   /    |    /   |      5      | Dam-Break |      -12.1285       |       12.1285       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  15    |   15   |   5    |   1/3  |      5      | Rare-Rare |      -12.4618       |       11.7951       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  15    |   15   |   5    |   1/3  |      5      |Shock-Shock|      -11.7951       |       12.4618       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   /    |    /   |      5      | Dam-Break |      -31.3156       |       31.3156       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   5    |   0.05 |      5      | Rare-Rare |      -31.3656       |       31.2656       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   5    |   0.05 |      5      |Shock-Shock|      -31.2656       |       31.3656       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   /    |    /   |      5      | Dam-Break |      -31.3156       |       31.3156       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   2000 |   20   |      5      | Rare-Rare |      -51.3156       |       11.3156       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+
|  100   |   15   |   2000 |   20   |      5      |Shock-Shock|      -11.3156       |       51.3156       |
+--------+--------+--------+--------+-------------+-----------+---------------------+---------------------+

What we observe
^^^^^^^^^^^^^^^

Dam-Break
    :math:`\lambda_1 = -\lambda_2` :raw-html:`<br>`
    The higher the difference between l_hl and l_hr the higher the absolute wave speeds (eigenvalues). :raw-html:`<br>`
    Wave speeds are independent of the velocity which is always zero.

Rare-Rare
    Waves speeds of Rare-Rare and Shock-Shock are swapped. :raw-html:`<br>`
    :math:`\lambda_{1/2} = u \mp \sqrt{gh}` :raw-html:`<br>`
    thus the wave speeds scale with the velocity. The higher the velocity the higher the wave speeds.

Shock-Shock
    Waves speeds of Rare-Rare and Shock-Shock are swapped. :raw-html:`<br>`
    :math:`\lambda_{1/2} = u \mp \sqrt{gh}` :raw-html:`<br>`
    thus the wave speeds scale with the velocity. The higher the velocity the higher the wave speeds.

2.2. Dam-Break
--------------

All results with 100 cells!

+--------+--------+------------+--------+
|  l_hl  |  l_hr  | l_location |  l_ur  |
+========+========+============+========+
|  10    |   10   |      5     |    0   |
+--------+--------+------------+--------+
|  20    |   10   |      5     | 4.1327 |
+--------+--------+------------+--------+
|  10    |   20   |      5     |-4.1356 |
+--------+--------+------------+--------+
|  200   |   10   |      5     |34.2068 |
+--------+--------+------------+--------+
|  200   |   150  |      5     | 5.9400 |
+--------+--------+------------+--------+
|  200   |   190  |      5     | 1.1214 |
+--------+--------+------------+--------+

What we observe
^^^^^^^^^^^^^^^

The larger the gap between the left and right water height the bigger is the velocity.
With higher water columns but same difference between left and right water height the
velocity decreases.

Compute evacuation time
^^^^^^^^^^^^^^^^^^^^^^^

.. math::

    q_l = [14, 0]^T\\
    q_r = [3.5, 0.7]^T

Distance: :math:`25,000\,m` :raw-html:`<br>`
Wave speed: :math:`11.7120\,m/s`

Time: :math:`\frac{25,000\,m}{11.7120\,m/s} = 35,5760\,s \approx \text{35:34 min}`

**New (hand-calculated)**

.. math::

    q_l = [14, 0]^T, u_l = \frac{0}{14} =0\\
    q_r = [3.5, 0.7]^T, u_l = \frac{0.7}{3.5} = 0.2\\
    h^{\text{Roe}} = \frac{1}{2}\cdot(14+3.5) = 8.75\\
    u^{\text{Roe}} = \frac{0\cdot\sqrt{14}+0.2\cdot\sqrt{3.5}}{\sqrt{1}+\sqrt{3.5}} = \frac{1}{15}\\
    \sqrt{gh^{\text{Roe}}} = \sqrt{9.80665\cdot8.75} = 9.263270886\\
    \lambda_1 = \frac{1}{15}-9.263270886 = -9.196604219\\
    \lambda_2 = \frac{1}{15}+9.263270886 = 9.329937553

Distance: :math:`25,000\,m` :raw-html:`<br>`
Wave speed: :math:`9.329937553\,m/s`

Time: :math:`\frac{25,000\,m}{9.329937553\,m/s} = 2679.546\,s \approx \text{44:40 min}`
